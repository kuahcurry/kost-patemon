<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Akun - Kost Mewah Patemon Gombong</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700;800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../css/home.css" />
    <style>
      body {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        font-family: "Montserrat", sans-serif;
        min-height: 100vh;
        background-attachment: fixed;
        background-repeat: no-repeat;
        background-size: cover;
        margin: 0;
        padding: 0;
      }

      html {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        background-attachment: fixed;
        background-repeat: no-repeat;
        background-size: cover;
        height: 100%;
      }

      .akun-section {
        max-width: 1200px;
        margin: 120px auto 20px auto;
        padding: 0 20px;
        min-height: calc(100vh - 180px);
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
      }

      .page-header {
        margin-bottom: 40px;
        background: #ffffff;
        backdrop-filter: blur(20px);
        border-radius: 25px;
        padding: 40px 35px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.08);
        border: 1px solid rgba(255, 255, 255, 0.3);
        position: relative;
        overflow: hidden;
      }

      .page-header::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
          135deg,
          rgba(238, 197, 91, 0.03),
          rgba(248, 224, 122, 0.05)
        );
        pointer-events: none;
      }

      .page-content {
        position: relative;
        z-index: 1;
      }

      .breadcrumb {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 30px;
        flex-wrap: wrap;
      }

      .breadcrumb-link {
        display: flex;
        align-items: center;
        gap: 8px;
        color: #6c757d;
        text-decoration: none;
        font-weight: 600;
        font-size: 0.9rem;
        transition: all 0.3s;
        padding: 8px 15px;
        border-radius: 50px;
        background: rgba(108, 117, 125, 0.08);
      }

      .breadcrumb-link:hover {
        color: #eec55b;
        background: rgba(238, 197, 91, 0.15);
        text-decoration: none;
        transform: translateY(-1px);
      }

      .breadcrumb-separator {
        color: #dee2e6;
        font-weight: 700;
      }

      .breadcrumb-current {
        display: flex;
        align-items: center;
        gap: 8px;
        color: #eec55b;
        font-weight: 700;
        font-size: 0.9rem;
        padding: 8px 15px;
        border-radius: 50px;
        background: rgba(238, 197, 91, 0.15);
      }

      .hero-main {
        display: flex;
        align-items: center;
        gap: 25px;
        margin-bottom: 35px;
      }

      .hero-icon {
        background: linear-gradient(135deg, #eec55b, #f8e07a);
        width: 80px;
        height: 80px;
        border-radius: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2rem;
        color: #6d5a2b;
        box-shadow: 0 10px 30px rgba(238, 197, 91, 0.3);
        flex-shrink: 0;
      }

      .hero-text {
        flex: 1;
      }

      .page-title {
        font-size: 2.8rem;
        font-weight: 900;
        background: linear-gradient(135deg, #2c3e50, #6d5a2b);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 12px;
        letter-spacing: -1px;
        line-height: 1.3;
      }

      .page-subtitle {
        font-size: 1.2rem;
        color: #6c757d;
        font-weight: 500;
        line-height: 1.6;
        margin: 0;
      }

      .account-layout {
        display: grid;
        grid-template-columns: 1fr 2fr;
        gap: 20px;
        align-items: start;
        flex-grow: 1;
        margin-bottom: 20px;
      }

      .akun-card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border-radius: 25px;
        padding: 25px 20px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.08);
        border: 1px solid rgba(255, 255, 255, 0.3);
        text-align: center;
        position: relative;
        overflow: hidden;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        height: fit-content;
        max-height: 400px;
      }

      .akun-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 25px 70px rgba(0, 0, 0, 0.12);
      }

      .akun-avatar {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        object-fit: cover;
        border: 4px solid #eec55b;
        margin-bottom: 15px;
        background: linear-gradient(135deg, #f8e07a, #eec55b);
        box-shadow: 0 10px 30px rgba(238, 197, 91, 0.3);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .akun-avatar:hover {
        transform: scale(1.05);
        box-shadow: 0 15px 40px rgba(238, 197, 91, 0.4);
      }

      .akun-nama {
        font-size: 1.6rem;
        font-weight: 900;
        color: #2c3e50;
        margin-bottom: 6px;
        letter-spacing: -0.5px;
      }

      .akun-email {
        font-size: 1rem;
        color: #6c757d;
        margin-bottom: 15px;
        font-weight: 500;
      }

      .status-pembayaran {
        display: inline-flex;
        align-items: center;
        gap: 10px;
        background: rgba(248, 249, 250, 0.8);
        backdrop-filter: blur(10px);
        border-radius: 15px;
        padding: 10px 18px;
        margin-bottom: 18px;
        font-size: 0.9rem;
        color: #495057;
        font-weight: 600;
        border: 1px solid rgba(255, 255, 255, 0.3);
      }

      .badge-lunas {
        background: linear-gradient(135deg, #27ae60, #2ecc71);
        color: #fff;
        border-radius: 25px;
        padding: 6px 15px;
        font-size: 0.8rem;
        font-weight: 800;
        letter-spacing: 0.5px;
        text-transform: uppercase;
        box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
      }

      .badge-belum {
        background: linear-gradient(135deg, #e74c3c, #c0392b);
        color: #fff;
        border-radius: 25px;
        padding: 6px 15px;
        font-size: 0.8rem;
        font-weight: 800;
        letter-spacing: 0.5px;
        text-transform: uppercase;
        box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
      }

      .akun-edit-btn {
        background: linear-gradient(135deg, #eec55b, #f8e07a);
        color: #6d5a2b;
        border: none;
        border-radius: 50px;
        padding: 10px 25px;
        font-weight: 700;
        font-size: 0.95rem;
        cursor: pointer;
        box-shadow: 0 8px 25px rgba(238, 197, 91, 0.3);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .akun-edit-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 35px rgba(238, 197, 91, 0.4);
      }

      .akun-menu {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border-radius: 25px;
        padding: 0;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.08);
        border: 1px solid rgba(255, 255, 255, 0.3);
        overflow: hidden;
        height: fit-content;
        max-height: 400px;
      }

      .akun-menu-item {
        padding: 16px 25px;
        font-size: 1.05rem;
        color: #2c3e50;
        font-weight: 600;
        border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        display: flex;
        align-items: center;
        gap: 15px;
        position: relative;
      }

      .akun-menu-item:last-child {
        border-bottom: none;
        color: #e74c3c;
      }

      .akun-menu-item:hover {
        background: linear-gradient(
          135deg,
          rgba(248, 224, 122, 0.05),
          rgba(238, 197, 91, 0.05)
        );
        transform: translateX(5px);
        padding-left: 30px;
      }

      .akun-menu-item:last-child:hover {
        background: linear-gradient(
          135deg,
          rgba(231, 76, 60, 0.05),
          rgba(192, 57, 43, 0.05)
        );
      }

      .akun-menu-item i {
        font-size: 1.2rem;
        width: 20px;
        text-align: center;
      }

      .fade-in {
        animation: fadeIn 0.5s ease-in;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      } /* Responsive Design */
      @media (max-width: 768px) {
        .hero-main {
          flex-direction: column;
          text-align: center;
          gap: 20px;
          margin-bottom: 25px;
        }

        .hero-icon {
          width: 70px;
          height: 70px;
          font-size: 1.8rem;
        }

        .page-title {
          font-size: 2.2rem;
          line-height: 1.3;
        }

        .page-subtitle {
          font-size: 1.1rem;
        }

        .page-header {
          padding: 30px 20px;
        }

        .akun-section {
          margin-top: 100px;
          padding: 0 15px;
          min-height: calc(100vh - 120px);
        }

        .account-layout {
          grid-template-columns: 1fr;
          gap: 15px;
          margin-bottom: 15px;
        }

        .akun-card {
          padding: 20px 15px;
          max-height: none;
        }

        .akun-avatar {
          width: 85px;
          height: 85px;
        }

        .akun-nama {
          font-size: 1.4rem;
        }

        .akun-menu {
          max-height: none;
        }

        .akun-menu-item {
          padding: 15px 20px;
          font-size: 1rem;
        }
      }
      @media (max-width: 480px) {
        .hero-icon {
          width: 60px;
          height: 60px;
          font-size: 1.5rem;
        }

        .page-title {
          font-size: 2rem;
          line-height: 1.3;
        }

        .page-subtitle {
          font-size: 1rem;
        }

        .page-header {
          padding: 25px 15px;
        }

        .akun-section {
          min-height: calc(100vh - 100px);
        }

        .akun-card {
          padding: 18px 12px;
        }

        .akun-menu-item {
          padding: 12px 18px;
          font-size: 0.95rem;
        }
      }

      @media (max-width: 600px) {
        .akun-section {
          margin-top: 120px;
          min-height: calc(100vh - 110px);
        }
        .akun-card {
          padding: 16px 4px 10px 4px;
        }
        .akun-menu-item {
          padding: 10px 8px;
          font-size: 15px;
        }
      }

      /* Modal Styles */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.6);
        z-index: 9999;
        display: flex;
        justify-content: center;
        align-items: center;
        animation: fadeIn 0.3s ease-out;
      }

      .modal-container {
        background: #fff;
        border-radius: 20px;
        width: 90%;
        max-width: 550px;
        max-height: 85vh;
        overflow-y: auto;
        box-shadow: 0 15px 50px rgba(0, 0, 0, 0.3);
        animation: slideUp 0.3s ease-out;
        position: relative;
        margin: auto;
      }

      @keyframes slideUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .modal-header {
        padding: 30px 35px 22px 35px;
        border-bottom: 3px solid #f8e07a;
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: linear-gradient(135deg, #f8e07a, #eec55b);
        border-radius: 20px 20px 0 0;
        position: relative;
        overflow: hidden;
      }

      .modal-header::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
          45deg,
          rgba(255, 255, 255, 0.1) 0%,
          transparent 50%
        );
        pointer-events: none;
      }

      .modal-header h3 {
        font-size: 1.7rem;
        font-weight: 800;
        color: #6d5a2b;
        margin: 0;
        display: flex;
        align-items: center;
        gap: 12px;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
      }

      .modal-close {
        background: rgba(255, 255, 255, 0.25);
        border: 2px solid rgba(255, 255, 255, 0.3);
        font-size: 1.8rem;
        color: #6d5a2b;
        cursor: pointer;
        width: 45px;
        height: 45px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background 0.3s, box-shadow 0.3s, color 0.3s, scale 0.3s;
        backdrop-filter: blur(5px);
      }

      .modal-close:hover {
        background: rgba(255, 255, 255, 0.4);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        color: #a68b3a;
        scale: 1.1;
      }

      .modal-body {
        padding: 32px;
      }

      .form-group {
        margin-bottom: 25px;
      }

      .form-group label {
        display: block;
        margin-bottom: 10px;
        font-weight: 700;
        color: #6d5a2b;
        font-size: 1rem;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .form-group label i {
        color: #eec55b;
        font-size: 1.1rem;
      }

      .form-group input,
      .form-group textarea {
        width: 100%;
        padding: 15px 18px;
        border: 2px solid #e9ecef;
        border-radius: 12px;
        font-size: 1rem;
        font-family: "Montserrat", sans-serif;
        transition: all 0.3s ease;
        box-sizing: border-box;
        background: #fafafa;
      }

      .form-group input:focus,
      .form-group textarea:focus {
        outline: none;
        border-color: #eec55b;
        box-shadow: 0 0 0 4px rgba(238, 197, 91, 0.15);
        background: #fff;
        transform: translateY(-1px);
      }

      .form-group textarea {
        resize: vertical;
        min-height: 100px;
      }

      .form-text {
        color: #6c757d;
        font-size: 0.875rem;
        margin-top: 6px;
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .form-text i {
        color: #28a745;
      }

      /* Profile Picture Upload */
      .profile-picture-upload {
        display: flex;
        justify-content: center;
        margin-bottom: 20px;
      }

      .current-picture {
        position: relative;
        width: 140px;
        height: 140px;
        border-radius: 50%;
        overflow: hidden;
        cursor: pointer;
        border: 4px solid #eec55b;
        transition: all 0.3s ease;
        box-shadow: 0 8px 25px rgba(238, 197, 91, 0.2);
      }

      .current-picture:hover {
        border-color: #bf9c4a;
        transform: scale(1.05);
        box-shadow: 0 12px 35px rgba(238, 197, 91, 0.3);
      }

      .current-picture img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .picture-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        opacity: 0;
        transition: opacity 0.3s ease;
        color: white;
        font-size: 0.9rem;
        text-align: center;
        font-weight: 600;
      }

      .current-picture:hover .picture-overlay {
        opacity: 1;
      }

      .picture-overlay i {
        font-size: 2rem;
        margin-bottom: 8px;
      }

      .picture-upload-hint {
        text-align: center;
        color: #666;
        font-size: 0.85rem;
        margin-bottom: 25px;
        padding: 12px;
        background: #f8f9fa;
        border-radius: 8px;
        border-left: 4px solid #eec55b;
      }

      /* Modal Actions */
      .modal-actions {
        display: flex;
        gap: 15px;
        justify-content: flex-end;
        margin-top: 35px;
        padding-top: 25px;
        border-top: 2px solid #f8f9fa;
      }

      .btn-cancel,
      .btn-save {
        padding: 14px 28px;
        border: none;
        border-radius: 12px;
        font-weight: 700;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
        min-width: 130px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
      }

      .btn-cancel {
        background: #f8f9fa;
        color: #6c757d;
        border: 2px solid #e9ecef;
      }

      .btn-cancel:hover {
        background: #e9ecef;
        color: #495057;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }

      .btn-save {
        background: linear-gradient(135deg, #eec55b 0%, #f8e07a 100%);
        color: #6d5a2b;
        border: 2px solid #eec55b;
      }

      .btn-save:hover {
        background: linear-gradient(135deg, #f8e07a 0%, #eec55b 100%);
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(238, 197, 91, 0.4);
      }

      .btn-save:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }

      .btn-save:disabled:hover {
        transform: none;
        box-shadow: none;
      }

      /* Bootstrap Modal Customization */
      .modal.fade .modal-dialog {
        transform: translate(0, -25%);
        transition: all 0.3s ease-out;
      }

      .modal.show .modal-dialog {
        transform: translate(0, 0);
      }

      .modal-dialog {
        display: flex;
        align-items: center;
        min-height: calc(100vh - 60px);
        margin: 30px auto;
      }

      .modal-content {
        border: none;
        box-shadow: 0 15px 50px rgba(0, 0, 0, 0.3) !important;
      }

      /* Custom payment modal styles */
      #paymentModal .modal-dialog {
        max-width: 700px;
      }

      #changePasswordModal .modal-dialog {
        max-width: 500px;
      }

      /* Responsive design */
      @media (max-width: 768px) {
        .modal-dialog {
          margin: 15px;
          max-width: calc(100vw - 30px);
        }

        .modal-container {
          width: 95%;
          margin: 15px;
        }

        .modal-header {
          padding: 25px 20px 18px 20px;
        }

        .modal-header h3 {
          font-size: 1.4rem;
        }

        .modal-close {
          width: 40px;
          height: 40px;
          font-size: 1.6rem;
        }

        .modal-body {
          padding: 25px 20px;
        }

        .profile-picture-upload {
          width: 120px !important;
          height: 120px !important;
        }

        .modal-actions {
          flex-direction: column;
          gap: 12px;
          margin-top: 25px;
        }

        .btn-cancel,
        .btn-save {
          width: 100%;
          min-width: auto;
          padding: 16px 20px;
        }

        .form-group {
          margin-bottom: 20px;
        }
      }

      @media (max-width: 480px) {
        .modal-dialog {
          margin: 10px;
          max-width: calc(100vw - 20px);
        }

        .modal-header h3 {
          font-size: 1.2rem;
          gap: 8px;
        }

        .profile-picture-upload {
          width: 100px !important;
          height: 100px !important;
        }

        .modal-header {
          padding: 20px 15px 15px 15px;
        }

        .modal-body {
          padding: 20px 15px;
        }
      }

      /* Toast Message Styles */
      .toast {
        position: fixed;
        top: 20px;
        right: 20px;
        background: linear-gradient(135deg, #28a745, #20c997);
        color: white;
        padding: 16px 20px;
        border-radius: 12px;
        box-shadow: 0 8px 32px rgba(40, 167, 69, 0.3);
        z-index: 10000;
        display: flex;
        align-items: center;
        gap: 12px;
        font-weight: 600;
        font-size: 0.95rem;
        min-width: 300px;
        max-width: 400px;
        transform: translateX(100%);
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      }

      /* Welcome Toast - positioned below header */
      .toast.welcome {
        position: fixed;
        top: 100px;
        left: 50%;
        right: auto;
        transform: translateX(-50%) translateY(-100%);
        background: linear-gradient(135deg, #28a745, #20c997);
        box-shadow: 0 8px 32px rgba(40, 167, 69, 0.3);
        min-width: 350px;
        max-width: 500px;
        z-index: 9999;
      }

      .toast.welcome.show {
        transform: translateX(-50%) translateY(0);
      }

      .toast.welcome.hide {
        transform: translateX(-50%) translateY(-100%);
      }

      .toast.show {
        transform: translateX(0);
      }

      .toast.hide {
        transform: translateX(100%);
      }

      .toast.error {
        background: linear-gradient(135deg, #dc3545, #c82333);
        box-shadow: 0 8px 32px rgba(220, 53, 69, 0.3);
      }

      .toast.warning {
        background: linear-gradient(135deg, #ffc107, #e0a800);
        box-shadow: 0 8px 32px rgba(255, 193, 7, 0.3);
        color: #212529;
      }

      .toast.info {
        background: linear-gradient(135deg, #17a2b8, #138496);
        box-shadow: 0 8px 32px rgba(23, 162, 184, 0.3);
      }

      .toast-icon {
        font-size: 1.2rem;
        flex-shrink: 0;
      }

      .toast-message {
        flex: 1;
        line-height: 1.4;
      }

      .toast-close {
        background: none;
        border: none;
        color: white;
        font-size: 1.1rem;
        cursor: pointer;
        opacity: 0.8;
        transition: opacity 0.3s ease;
        padding: 4px;
        border-radius: 4px;
      }

      .toast-close:hover {
        opacity: 1;
        background: rgba(255, 255, 255, 0.1);
      }

      .toast.warning .toast-close {
        color: #212529;
      }

      .toast.warning .toast-close:hover {
        background: rgba(0, 0, 0, 0.1);
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        .toast {
          right: 15px;
          left: 15px;
          min-width: auto;
          max-width: none;
          transform: translateY(-100%);
        }

        .toast.show {
          transform: translateY(0);
        }

        .toast.hide {
          transform: translateY(-100%);
        }

        /* Welcome toast responsive */
        .toast.welcome {
          left: 15px;
          right: 15px;
          min-width: auto;
          max-width: none;
          transform: translateY(-100%);
        }

        .toast.welcome.show {
          transform: translateY(0);
        }

        .toast.welcome.hide {
          transform: translateY(-100%);
        }
      }

      /* Confirmation Modal Styles */
      .confirm-modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(5px);
        z-index: 10000;
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
      }

      .confirm-modal-overlay.show {
        opacity: 1;
        visibility: visible;
      }

      .confirm-modal {
        background: linear-gradient(135deg, #ffffff, #f8f9fa);
        border-radius: 16px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        max-width: 400px;
        width: 90%;
        max-height: 80vh;
        overflow: hidden;
        transform: scale(0.9) translateY(20px);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .confirm-modal-overlay.show .confirm-modal {
        transform: scale(1) translateY(0);
      }

      .confirm-modal-header {
        background: linear-gradient(135deg, #eec55b, #f8e07a);
        color: #2c3e50;
        padding: 20px;
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      }

      .confirm-modal-header h4 {
        margin: 0;
        font-weight: 600;
        font-size: 1.2rem;
      }

      .confirm-modal-body {
        padding: 20px;
        color: #2c3e50;
      }

      .confirm-modal-body p {
        margin: 0;
        font-size: 1rem;
        line-height: 1.5;
      }

      .confirm-modal-footer {
        padding: 20px;
        border-top: 1px solid rgba(0, 0, 0, 0.1);
        display: flex;
        justify-content: flex-end;
        gap: 10px;
      }

      .confirm-modal-footer .btn {
        padding: 8px 20px;
        border: none;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .confirm-modal-footer .btn-secondary {
        background: #6c757d;
        color: white;
      }

      .confirm-modal-footer .btn-secondary:hover {
        background: #5a6268;
        transform: translateY(-2px);
      }

      .confirm-modal-footer .btn-primary {
        background: linear-gradient(135deg, #dc3545, #c82333);
        color: white;
      }

      .confirm-modal-footer .btn-primary:hover {
        background: linear-gradient(135deg, #c82333, #a71e2a);
        transform: translateY(-2px);
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        .confirm-modal {
          margin: 20px;
          max-width: none;
          width: calc(100% - 40px);
        }

        .confirm-modal-footer {
          flex-direction: column;
        }

        .confirm-modal-footer .btn {
          width: 100%;
        }
      }
    </style>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <header class="header">
      <div
        class="logo"
        style="cursor: pointer"
        onclick="window.location.href='home.html'"
      >
        <div class="circle-container">
          <div class="circle">
            <img
              src="../Image/logo.png"
              alt="Kost Mewah Patemon Gombong Logo"
            />
          </div>
        </div>
      </div>
      <div
        class="title"
        style="cursor: pointer"
        onclick="window.location.href='home.html'"
      >
        <img src="../Image/logoTeks.png" alt="Title Image" />
      </div>
      <div class="menu">
        <nav>
          <nav class="menu-list">
            <li><a href="home.html">MENU</a></li>
            <li class="border"></li>
            <li><a href="kamar.html">KAMAR</a></li>
            <li class="border"></li>
            <li class="active"><a href="#">AKUN</a></li>
          </nav>
        </nav>
      </div>
    </header>
    <main>
      <section class="akun-section">
        <div class="page-header">
          <div class="page-content">
            <div class="breadcrumb">
              <a href="home.html" class="breadcrumb-link">
                <i class="fas fa-home"></i>
                Beranda
              </a>
              <span class="breadcrumb-separator">/</span>
              <span class="breadcrumb-current">
                <i class="fas fa-user"></i>
                Akun Saya
              </span>
            </div>

            <div class="hero-main">
              <div class="hero-icon">
                <i class="fas fa-user-circle"></i>
              </div>
              <div class="hero-text">
                <h1 class="page-title">Akun Saya</h1>
                <p class="page-subtitle">
                  Kelola profil dan informasi akun Anda dengan mudah
                </p>
              </div>
            </div>
          </div>
        </div>

        <div class="account-layout">
          <div class="akun-card">
            <img
              class="akun-avatar"
              src="../Image/image.png"
              alt="Avatar Akun"
            />
            <div class="akun-nama">Loading...</div>
            <div class="akun-email">Loading...</div>
            <div class="status-pembayaran">
              Status Pembayaran: <span class="badge-lunas">Loading...</span>
            </div>
            <button class="akun-edit-btn">
              <i class="fas fa-edit"></i> Edit Profil
            </button>
          </div>

          <div class="akun-menu">
            <div class="akun-menu-item">
              <i class="fa-solid fa-gear"></i> Ganti Password
            </div>
            <div class="akun-menu-item">
              <i class="fa-solid fa-wallet"></i> Pembayaran Bulanan
            </div>
            <div class="akun-menu-item">
              <i class="fa-solid fa-clock-rotate-left"></i> Riwayat Pembayaran
            </div>
            <div class="akun-menu-item">
              <i class="fa-solid fa-arrow-right-from-bracket"></i> Logout
            </div>
          </div>
        </div>
      </section>
    </main>
    <!-- Modal Edit Profile (Bootstrap style) -->
    <div
      class="modal fade"
      id="editProfileModal"
      tabindex="-1"
      aria-labelledby="editProfileModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content" style="border-radius: 20px; border: none">
          <div
            class="modal-header"
            style="
              background: linear-gradient(135deg, #f8e07a, #eec55b);
              border-radius: 20px 20px 0 0;
              border: none;
            "
          >
            <h5
              class="modal-title fw-bold"
              id="editProfileModalLabel"
              style="color: #6d5a2b"
            >
              <i class="fas fa-user-edit me-2"></i>Edit Profile
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body" style="padding: 30px">
            <form id="editProfileForm" enctype="multipart/form-data">
              <div class="mb-3">
                <label for="profilePicture" class="form-label fw-bold"
                  >Foto Profil</label
                >
                <div
                  class="profile-picture-upload"
                  style="justify-content: center"
                >
                  <div
                    class="current-picture"
                    style="width: 140px; height: 140px"
                  >
                    <img
                      id="currentProfilePic"
                      src="../Image/image.png"
                      alt="Current Profile"
                      style="width: 100%; height: 100%; object-fit: cover"
                    />
                    <div class="picture-overlay">
                      <i class="fa-solid fa-camera"></i>
                      <span>Klik untuk ubah</span>
                    </div>
                  </div>
                  <input
                    type="file"
                    id="profilePicture"
                    name="profilePicture"
                    accept="image/*"
                    style="display: none"
                  />
                </div>
                <div
                  class="form-text text-center"
                  style="color: #a68b3a; font-size: 0.93rem; margin-top: 10px"
                >
                  Format: JPG, PNG, GIF. Maksimal 5MB
                </div>
              </div>
              <div class="mb-3">
                <label for="editNama" class="form-label fw-bold"
                  >Nama Lengkap</label
                >
                <input
                  type="text"
                  id="editNama"
                  name="Nama"
                  class="form-control"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="editNoTelp" class="form-label fw-bold"
                  >No. Telepon</label
                >
                <input
                  type="tel"
                  id="editNoTelp"
                  name="No_telp"
                  class="form-control"
                />
              </div>
              <div class="mb-3">
                <label for="editAlamat" class="form-label fw-bold"
                  >Alamat</label
                >
                <textarea
                  id="editAlamat"
                  name="Alamat"
                  rows="3"
                  class="form-control"
                ></textarea>
              </div>
            </form>
          </div>
          <div class="modal-footer" style="border: none; padding: 0 30px 30px">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Batal
            </button>
            <button
              type="submit"
              class="btn btn-primary"
              form="editProfileForm"
              style="
                background: linear-gradient(135deg, #f8e07a, #eec55b);
                border: none;
                color: #6d5a2b;
                font-weight: bold;
              "
            >
              <i class="fas fa-save me-2"></i>Simpan Perubahan
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal untuk Ganti Password -->
    <div
      class="modal fade"
      id="changePasswordModal"
      tabindex="-1"
      aria-labelledby="changePasswordModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content" style="border-radius: 20px; border: none">
          <div
            class="modal-header"
            style="
              background: linear-gradient(135deg, #f8e07a, #eec55b);
              border-radius: 20px 20px 0 0;
              border: none;
            "
          >
            <h5
              class="modal-title fw-bold"
              id="changePasswordModalLabel"
              style="color: #6d5a2b"
            >
              <i class="fas fa-lock me-2"></i>Ganti Password
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body" style="padding: 30px">
            <form id="changePasswordForm">
              <div class="mb-3">
                <label for="currentPassword" class="form-label fw-bold"
                  >Password Saat Ini</label
                >
                <div class="input-group">
                  <input
                    type="password"
                    class="form-control"
                    id="currentPassword"
                    name="currentPassword"
                    required
                  />
                  <button
                    class="btn btn-outline-secondary"
                    type="button"
                    onclick="togglePassword('currentPassword')"
                  >
                    <i class="fas fa-eye" id="currentPasswordIcon"></i>
                  </button>
                </div>
              </div>
              <div class="mb-3">
                <label for="newPassword" class="form-label fw-bold"
                  >Password Baru</label
                >
                <div class="input-group">
                  <input
                    type="password"
                    class="form-control"
                    id="newPassword"
                    name="newPassword"
                    required
                    minlength="6"
                  />
                  <button
                    class="btn btn-outline-secondary"
                    type="button"
                    onclick="togglePassword('newPassword')"
                  >
                    <i class="fas fa-eye" id="newPasswordIcon"></i>
                  </button>
                </div>
                <div class="form-text">Password minimal 6 karakter</div>
              </div>
              <div class="mb-3">
                <label for="confirmPassword" class="form-label fw-bold"
                  >Konfirmasi Password Baru</label
                >
                <div class="input-group">
                  <input
                    type="password"
                    class="form-control"
                    id="confirmPassword"
                    name="confirmPassword"
                    required
                    minlength="6"
                  />
                  <button
                    class="btn btn-outline-secondary"
                    type="button"
                    onclick="togglePassword('confirmPassword')"
                  >
                    <i class="fas fa-eye" id="confirmPasswordIcon"></i>
                  </button>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer" style="border: none; padding: 0 30px 30px">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Batal
            </button>
            <button
              type="button"
              class="btn btn-primary"
              onclick="changePassword()"
              style="
                background: linear-gradient(135deg, #f8e07a, #eec55b);
                border: none;
                color: #6d5a2b;
                font-weight: bold;
              "
            >
              <i class="fas fa-save me-2"></i>Simpan Password
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal untuk Pembayaran Bulanan -->
    <div
      class="modal fade"
      id="paymentModal"
      tabindex="-1"
      aria-labelledby="paymentModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg">
        <div class="modal-content" style="border-radius: 20px; border: none">
          <div
            class="modal-header"
            style="
              background: linear-gradient(135deg, #f8e07a, #eec55b);
              border-radius: 20px 20px 0 0;
              border: none;
            "
          >
            <h5
              class="modal-title fw-bold"
              id="paymentModalLabel"
              style="color: #6d5a2b"
            >
              <i class="fas fa-credit-card me-2"></i>Pembayaran Bulanan
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body" style="padding: 30px">
            <div id="paymentContent">
              <!-- Content will be loaded dynamically -->
            </div>
          </div>
        </div>
      </div>
    </div>
    <
    <footer class="footer">
      <div class="footer-container">
        <div class="footer-menu">
          <div class="footer-menu-col">
            <a href="home.html">Menu</a>
            <a href="kamar.html">Kamar</a>
          </div>
          <div class="footer-menu-col">
            <a href="akun.html">Akun</a>
            <a href="login.html">Login</a>
          </div>
        </div>
        <div class="footer-divider"></div>
        <div class="footer-info">
          <div class="footer-title">Kost Putri MEWAH Patemon</div>
          <div class="footer-address">
            Jl. Serayu IV No. 13 03/01 Desa Patemon,<br />Kecamatan Gombong,
            Kabupaten Kebumen
          </div>
        </div>
      </div>
      <div class="footer-copyright">
        Copyright Kos MEWAH Patemon, Gombong 2025
      </div>
    </footer>

    <script src="../js/auth.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      // Toast Message Functions
      function showToast(message, type = "success", duration = 4000) {
        // Remove existing toast if any
        const existingToast = document.querySelector(".toast");
        if (existingToast) {
          existingToast.remove();
        }

        // Create toast element
        const toast = document.createElement("div");
        toast.className = `toast ${type}`;

        // Set icon based on type
        let iconClass = "fa-check-circle";
        switch (type) {
          case "error":
            iconClass = "fa-exclamation-triangle";
            break;
          case "warning":
            iconClass = "fa-exclamation-circle";
            break;
          case "info":
            iconClass = "fa-info-circle";
            break;
          case "welcome":
            iconClass = "fa-user-check";
            break;
          default:
            iconClass = "fa-check-circle";
        }

        toast.innerHTML = `
          <div class="toast-icon">
            <i class="fas ${iconClass}"></i>
          </div>
          <div class="toast-message">${message}</div>
          <button class="toast-close" onclick="hideToast()">
            <i class="fas fa-times"></i>
          </button>
        `;

        // Add to body
        document.body.appendChild(toast);

        // Show toast with animation
        setTimeout(() => {
          toast.classList.add("show");
        }, 100);

        // Auto hide after specified duration
        setTimeout(() => {
          hideToast();
        }, duration);
      }

      // Function to show welcome toast
      function showWelcomeToast(message) {
        showToast(message, "welcome", 5000);
      }

      // Function to hide toast
      function hideToast() {
        const toast = document.querySelector(".toast");
        if (toast) {
          toast.classList.add("hide");
          setTimeout(() => {
            toast.remove();
          }, 400);
        }
      }

      // Function to show success toast
      function showSuccessToast(message) {
        showToast(message, "success");
      }

      // Function to show error toast
      function showErrorToast(message) {
        showToast(message, "error");
      }

      // Function to show warning toast
      function showWarningToast(message) {
        showToast(message, "warning");
      }

      // Function to show info toast
      function showInfoToast(message) {
        showToast(message, "info");
      }

      // Confirmation Modal Functions
      function showConfirmModal(title, message, onConfirm, onCancel = null) {
        const modal = document.getElementById("confirmModal");
        const titleElement = document.getElementById("confirmModalTitle");
        const messageElement = document.getElementById("confirmModalMessage");
        const confirmBtn = document.getElementById("confirmModalConfirm");
        const cancelBtn = document.getElementById("confirmModalCancel");

        // Set modal content
        titleElement.textContent = title;
        messageElement.textContent = message;

        // Show modal
        modal.classList.add("show");
        modal.style.display = "flex";

        // Handle confirm button
        confirmBtn.onclick = function () {
          hideConfirmModal();
          if (onConfirm) onConfirm();
        };

        // Handle cancel button
        cancelBtn.onclick = function () {
          hideConfirmModal();
          if (onCancel) onCancel();
        };

        // Handle click outside modal
        modal.onclick = function (e) {
          if (e.target === modal) {
            hideConfirmModal();
            if (onCancel) onCancel();
          }
        };

        // Handle escape key
        document.addEventListener("keydown", function (e) {
          if (e.key === "Escape") {
            hideConfirmModal();
            if (onCancel) onCancel();
          }
        });
      }

      function hideConfirmModal() {
        const modal = document.getElementById("confirmModal");
        modal.classList.remove("show");
        setTimeout(() => {
          modal.style.display = "none";
        }, 300);
      }

      // Proteksi halaman - hanya user yang sudah login bisa akses
      document.addEventListener("DOMContentLoaded", function () {
        // Cek apakah user sudah login
        if (!requireLogin()) {
          return; // Akan redirect ke login jika belum login
        }

        // Load data user dan tampilkan di halaman
        loadUserProfile();

        // Setup event listeners
        setupEventListeners();

        // Check URL parameters for auto-actions
        checkUrlParameters();
      });

      // Tambahan proteksi dengan cek berulang setiap 5 detik
      setInterval(function () {
        if (!isUserLoggedIn()) {
          showErrorToast("Sesi Anda telah berakhir. Silakan login kembali.");
          setTimeout(() => {
            window.location.href = "login.html";
          }, 2000);
        }
      }, 5000);

      // Proteksi saat user mencoba kembali ke halaman ini
      window.addEventListener("pageshow", function (event) {
        if (event.persisted) {
          // Halaman dimuat dari cache, cek lagi status login
          if (!isUserLoggedIn()) {
            window.location.href = "login.html";
          }
        }
      });

      // Fungsi untuk load dan menampilkan data user
      function loadUserProfile() {
        
        const user = getLoggedInUser();

        if (user) {
          // Update nama dan email di UI dengan animasi
          setTimeout(() => {
            const namaElement = document.querySelector(".akun-nama");
            const emailElement = document.querySelector(".akun-email");
            const avatarElement = document.querySelector(".akun-avatar");

            namaElement.textContent = user.nama || "Nama Pengguna";
            emailElement.textContent = user.email || "user@email.com";

            // Update avatar jika ada foto
            const userFoto = localStorage.getItem("userFoto");
            console.log("User foto from localStorage:", userFoto);
            if (userFoto && userFoto !== "null" && userFoto !== "") {
              avatarElement.src = `http://localhost:3000${userFoto}`;
              console.log(
                "Avatar updated to:",
                `http://localhost:3000${userFoto}`
              );
            } else {
              avatarElement.src = "../Image/image.png";
              console.log("Using default avatar");
            }

            // Tambahkan class fade-in untuk animasi
            namaElement.classList.add("fade-in");
            emailElement.classList.add("fade-in");

            // TODO: Implementasi status pembayaran dari database
            // Untuk sementara, gunakan status default
            updatePaymentStatus("lunas"); // atau 'belum' berdasarkan data dari database
          }, 300);
        } else {
          // Jika tidak ada data user, redirect ke login
          window.location.href = "login.html";
        }
      }

      // Fungsi untuk update status pembayaran
      function updatePaymentStatus(status) {
        setTimeout(() => {
          const statusElement = document.querySelector(".status-pembayaran");
          const badgeElement = statusElement.querySelector("span");

          if (status === "lunas") {
            badgeElement.className = "badge-lunas";
            badgeElement.textContent = "Lunas";
          } else {
            badgeElement.className = "badge-belum";
            badgeElement.textContent = "Belum Lunas";
          }

          // Tambahkan animasi fade-in
          statusElement.classList.add("fade-in");
        }, 500);
      }

      // Setup event listeners untuk menu dan tombol
      function setupEventListeners() {
        // Event listener untuk tombol logout
        const logoutBtn = document.querySelector(".akun-menu-item:last-child");
        logoutBtn.addEventListener("click", function () {
          showConfirmModal(
            "Konfirmasi Logout",
            "Apakah Anda yakin ingin logout?",
            function () {
              logout();
            }
          );
        });

        // Event listener untuk edit profil
        const editBtn = document.querySelector(".akun-edit-btn");
        editBtn.addEventListener("click", function () {
          openEditModal();
        });

        // Event listener untuk menu pengaturan akun
        const pengaturanBtn = document.querySelector(
          ".akun-menu-item:nth-child(1)"
        );
        pengaturanBtn.addEventListener("click", function () {
          openChangePasswordModal();
        });

        // Event listener untuk menu pembayaran bulanan
        const pembayaranBtn = document.querySelector(
          ".akun-menu-item:nth-child(2)"
        );
        pembayaranBtn.addEventListener("click", function () {
          openPaymentModal();
        });

        // Event listener untuk menu riwayat reservasi
        const riwayatBtn = document.querySelector(
          ".akun-menu-item:nth-child(3)"
        );
        riwayatBtn.addEventListener("click", function () {
          // Redirect ke halaman riwayat pembayaran khusus
          window.location.href = "riwayat-pembayaran.html";
        });

        // Event listener untuk klik logo/title untuk redirect ke home
        const logoContainer = document.querySelector(".logo");
        const titleContainer = document.querySelector(".title");

        if (logoContainer) {
          logoContainer.addEventListener("click", function () {
            window.location.href = "home.html";
          });
        }

        if (titleContainer) {
          titleContainer.addEventListener("click", function () {
            window.location.href = "home.html";
          });
        }
      }

      // Fungsi untuk membuka modal edit profile
      function openEditModal() {
        const user = getLoggedInUser();
        if (!user) return;

        // Populate form dengan data user saat ini
        document.getElementById("editNama").value = user.nama || "";
        document.getElementById("editNoTelp").value = user.no_telp || "";
        document.getElementById("editAlamat").value = user.alamat || "";

        // Update current profile picture
        const currentPic = document.getElementById("currentProfilePic");
        const userFoto = localStorage.getItem("userFoto");
        if (userFoto && userFoto !== "null" && userFoto !== "") {
          currentPic.src = `http://localhost:3000${userFoto}`;
        } else {
          currentPic.src = "../Image/image.png";
        }

        // Show modal Bootstrap
        var modal = new bootstrap.Modal(
          document.getElementById("editProfileModal")
        );
        modal.show();

        // Setup form handlers
        setupEditProfileHandlers();
      }

      // Fungsi untuk menutup modal edit profile
      function closeEditModal() {
        // Hide modal Bootstrap
        var modal = bootstrap.Modal.getInstance(
          document.getElementById("editProfileModal")
        );
        if (modal) modal.hide();

        // Reset form
        document.getElementById("editProfileForm").reset();

        // Reset preview image
        const currentPic = document.getElementById("currentProfilePic");
        const userFoto = localStorage.getItem("userFoto");
        if (userFoto && userFoto !== "null" && userFoto !== "") {
          currentPic.src = `http://localhost:3000${userFoto}`;
        } else {
          currentPic.src = "../Image/image.png";
        }
      }

      // Setup event handlers untuk edit profile
      function setupEditProfileHandlers() {
        // Handle profile picture click
        const pictureContainer = document.querySelector(".current-picture");
        const fileInput = document.getElementById("profilePicture");

        pictureContainer.addEventListener("click", function () {
          fileInput.click();
        });

        // Handle file selection
        fileInput.addEventListener("change", function (e) {
          const file = e.target.files[0];
          if (file) {
            // Validate file size (5MB max)
            if (file.size > 5 * 1024 * 1024) {
              showErrorToast("Ukuran file terlalu besar. Maksimal 5MB.");
              e.target.value = "";
              return;
            }

            // Preview image
            const reader = new FileReader();
            reader.onload = function (e) {
              document.getElementById("currentProfilePic").src =
                e.target.result;
            };
            reader.readAsDataURL(file);
          }
        });

        // Handle form submission
        const form = document.getElementById("editProfileForm");
        form.addEventListener("submit", handleProfileUpdate);
      }

      // Handle profile update submission
      async function handleProfileUpdate(e) {
        e.preventDefault();

        const submitBtn = e.target.querySelector(".btn-save");
        const originalText = submitBtn.textContent;

        try {
          // Disable submit button and show loading
          submitBtn.disabled = true;
          submitBtn.textContent = "Menyimpan...";

          // Create FormData
          const formData = new FormData(e.target);

          // Debug: Log what's being sent
          console.log("FormData contents:");
          for (let [key, value] of formData.entries()) {
            if (value instanceof File) {
              console.log(key + ":", value.name, value.size, "bytes");
            } else {
              console.log(key + ":", value);
            }
          }

          // Make API request
          const response = await authFetch(
            "http://localhost:3000/api/auth/profile",
            {
              method: "PUT",
              body: formData,
            }
          );

          if (!response) return; // authFetch handles errors

          const result = await response.json();
          console.log("Profile update response:", result);

          if (result.success) {
            // Update localStorage with new user data
            localStorage.setItem("userName", result.data.Nama);
            if (result.data.No_telp) {
              localStorage.setItem("userPhone", result.data.No_telp);
            }
            if (result.data.Alamat) {
              localStorage.setItem("userAddress", result.data.Alamat);
            }
            if (result.data.Foto) {
              localStorage.setItem("userFoto", result.data.Foto);
              console.log(
                "Updated userFoto in localStorage:",
                result.data.Foto
              );
            }

            // Update UI
            loadUserProfile();

            // Close modal
            closeEditModal();

            // Show success message
            showSuccessToast("Profile berhasil diperbarui!");
          } else {
            showErrorToast("Gagal memperbarui profile: " + result.message);
          }
        } catch (error) {
          console.error("Error updating profile:", error);
          showErrorToast("Terjadi kesalahan saat memperbarui profile.");
        } finally {
          // Restore submit button
          submitBtn.disabled = false;
          submitBtn.textContent = originalText;
        }
      }

      // Modal functions for Change Password
      function openChangePasswordModal() {
        const modal = new bootstrap.Modal(
          document.getElementById("changePasswordModal")
        );
        modal.show();
      }

      // Helper function untuk menampilkan alert
      function showAlert(message, type = "info") {
        // Buat alert element
        const alertDiv = document.createElement("div");
        alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
        alertDiv.style.position = "fixed";
        alertDiv.style.top = "20px";
        alertDiv.style.right = "20px";
        alertDiv.style.zIndex = "9999";
        alertDiv.style.minWidth = "300px";
        alertDiv.innerHTML = `
          ${message}
          <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        `;

        // Tambahkan ke body
        document.body.appendChild(alertDiv);

        // Auto remove setelah 5 detik
        setTimeout(() => {
          if (alertDiv.parentNode) {
            alertDiv.remove();
          }
        }, 5000);
      }

      function togglePassword(fieldId) {
        const field = document.getElementById(fieldId);
        const icon = document.getElementById(fieldId + "Icon");

        if (field.type === "password") {
          field.type = "text";
          icon.classList.remove("fa-eye");
          icon.classList.add("fa-eye-slash");
        } else {
          field.type = "password";
          icon.classList.remove("fa-eye-slash");
          icon.classList.add("fa-eye");
        }
      }

      async function changePassword() {
        const form = document.getElementById("changePasswordForm");
        const formData = new FormData(form);

        const currentPassword = formData.get("currentPassword");
        const newPassword = formData.get("newPassword");
        const confirmPassword = formData.get("confirmPassword");

        // Validate passwords match
        if (newPassword !== confirmPassword) {
          showAlert(
            "Password baru dan konfirmasi password tidak sama!",
            "danger"
          );
          return;
        }

        // Validate password length
        if (newPassword.length < 6) {
          showAlert("Password baru minimal 6 karakter!", "danger");
          return;
        }

        try {
          const response = await authFetch(
            "http://localhost:3000/api/auth/change-password",
            {
              method: "PUT",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({
                currentPassword: currentPassword,
                newPassword: newPassword,
                confirmPassword: confirmPassword,
              }),
            }
          );

          const result = await response.json();

          if (response.ok) {
            showAlert(result.message, "success");

            // Close modal and reset form
            const modal = bootstrap.Modal.getInstance(
              document.getElementById("changePasswordModal")
            );
            modal.hide();
            form.reset();
          } else {
            showAlert(result.message || "Gagal mengubah password", "danger");
          }
        } catch (error) {
          console.error("Error changing password:", error);
          showAlert("Terjadi kesalahan saat mengubah password", "danger");
        }
      }

      // Modal functions for Payment
      async function getCurrentUser() {
        // Mengambil data user dari localStorage
        const user = getLoggedInUser();
        return user;
      }

      async function openPaymentModal() {
        try {
          // Get user data to check payment status
          const userData = await getCurrentUser();

          if (!userData) {
            showAlert("Gagal memuat data pengguna", "danger");
            return;
          }

          // For now, we'll simulate payment status check
          // In a real implementation, you would check actual payment status from database
          const hasUnpaidPayment = true; // This should come from actual payment status

          if (!hasUnpaidPayment) {
            showAlert("Tidak ada pembayaran yang perlu diselesaikan", "info");
            return;
          }

          // Show payment modal with BCA payment instructions like in reservasi
          const paymentContent = document.getElementById("paymentContent");
          paymentContent.innerHTML = `
            <div class="alert alert-warning mb-4">
              <i class="fas fa-exclamation-triangle me-2"></i>
              <strong>Status Pembayaran:</strong> Belum Bayar - Periode Januari 2025
            </div>
            
            <div class="rekening-card mb-4" style="
              background: linear-gradient(135deg, #f8f9fa, #e9ecef);
              border-radius: 15px;
              padding: 25px;
              border: 2px solid #eec55b;
              box-shadow: 0 5px 15px rgba(238, 197, 91, 0.1);
            ">
              <div style="display: flex; align-items: center; margin-bottom: 15px; font-size: 16px;">
                <span style="color: #eec55b; margin-right: 12px; font-size: 20px;">
                  <i class="fa-solid fa-building-columns"></i>
                </span>
                <strong>Bank:</strong> <span style="margin-left: 8px;">BCA</span>
              </div>
              <div style="display: flex; align-items: center; margin-bottom: 15px; font-size: 16px;">
                <span style="color: #eec55b; margin-right: 12px; font-size: 20px;">
                  <i class="fa-solid fa-credit-card"></i>
                </span>
                <strong>No. Rekening:</strong> <span style="margin-left: 8px;">1234567890</span>
              </div>
              <div style="display: flex; align-items: center; font-size: 16px;">
                <span style="color: #eec55b; margin-right: 12px; font-size: 20px;">
                  <i class="fa-solid fa-id-card"></i>
                </span>
                <strong>Atas Nama:</strong> <span style="margin-left: 8px;">Kos Putri Melati</span>
              </div>
            </div>
            
            <div class="total-bayar mb-4" style="
              text-align: center;
              background: linear-gradient(135deg, #eec55b, #f8e07a);
              color: #6d5a2b;
              padding: 15px;
              border-radius: 12px;
              font-size: 20px;
              font-weight: bold;
              box-shadow: 0 3px 10px rgba(238, 197, 91, 0.3);
            ">
              Total Bayar: <span style="color: #8a7037;">Rp. 900.000</span>
            </div>

            <!-- Accordion Instruksi Pembayaran -->
            <div class="accordion-instruksi mb-4">
              <button class="accordion-btn w-100 p-3" type="button" onclick="toggleInstruksi()" style="
                background: #f8f9fa;
                border: 2px solid #eec55b;
                border-radius: 10px;
                font-weight: bold;
                color: #6d5a2b;
                transition: all 0.3s;
              ">
                <i class="fa-solid fa-chevron-down me-2" id="instruksiIcon"></i> 
                Lihat Instruksi Pembayaran ATM & M-Banking
              </button>
              <div class="accordion-content" id="instruksiContent" style="
                display: none;
                background: #fff;
                border: 2px solid #eec55b;
                border-top: none;
                border-radius: 0 0 10px 10px;
                padding: 20px;
              ">
                <div class="instruksi-detail">
                  <div class="mb-3">
                    <strong style="color: #6d5a2b;">Instruksi via ATM BCA:</strong>
                    <ol style="margin-top: 10px; padding-left: 20px;">
                      <li>Masukkan kartu ATM dan PIN Anda.</li>
                      <li>Pilih menu <strong>Transaksi Lainnya</strong>  <strong>Transfer</strong>  <strong>Ke Rekening BCA</strong>.</li>
                      <li>Masukkan nomor rekening: <strong>1234567890</strong></li>
                      <li>Masukkan nominal transfer sesuai tagihan.</li>
                      <li>Ikuti instruksi hingga transaksi selesai.</li>
                    </ol>
                  </div>
                  <div>
                    <strong style="color: #6d5a2b;">Instruksi via M-Banking BCA:</strong>
                    <ol style="margin-top: 10px; padding-left: 20px;">
                      <li>Login aplikasi BCA Mobile.</li>
                      <li>Pilih menu <strong>m-Transfer</strong>  <strong>Antar Rekening BCA</strong>.</li>
                      <li>Masukkan nomor rekening: <strong>1234567890</strong></li>
                      <li>Masukkan nominal transfer sesuai tagihan.</li>
                      <li>Ikuti instruksi hingga transaksi selesai.</li>
                    </ol>
                  </div>
                </div>
              </div>
            </div>

            <!-- Form Upload Bukti -->
            <form id="paymentProofForm" class="form-bukti">
              <div class="mb-3">
                <label for="paymentProof" class="form-label fw-bold">Upload Bukti Pembayaran:</label>
                <input type="file" class="form-control" id="paymentProof" name="paymentProof" accept="image/*" required style="
                  border: 2px solid #eec55b;
                  border-radius: 8px;
                  padding: 12px;
                ">
                <div class="form-text">Format: JPG, JPEG, PNG (Max 5MB)</div>
              </div>
              <div class="modal-btn-row d-flex gap-3">
                <button type="button" class="btn flex-fill" onclick="submitPaymentProof()" style="
                  background: linear-gradient(135deg, #eec55b, #f8e07a);
                  border: none;
                  color: #6d5a2b;
                  font-weight: bold;
                  padding: 12px;
                  border-radius: 8px;
                  transition: all 0.3s;
                ">
                  <i class="fas fa-upload me-2"></i>Kirim Bukti Pembayaran
                </button>
                <button type="button" class="btn btn-outline-secondary flex-fill" onclick="closePaymentModal()">
                  Batal
                </button>
              </div>
            </form>
            
            <div class="modal-note mt-3" style="
              text-align: center;
              color: #6c757d;
              font-size: 14px;
              font-style: italic;
            ">
              Setelah pembayaran dan upload bukti, pembayaran Anda akan segera diproses dalam 1x24 jam.
            </div>
          `;

          const modal = new bootstrap.Modal(
            document.getElementById("paymentModal")
          );
          modal.show();
        } catch (error) {
          console.error("Error opening payment modal:", error);
          showAlert("Terjadi kesalahan saat memuat data pembayaran", "danger");
        }
      }

      function toggleInstruksi() {
        const content = document.getElementById("instruksiContent");
        const icon = document.getElementById("instruksiIcon");

        if (content.style.display === "none" || content.style.display === "") {
          content.style.display = "block";
          icon.classList.remove("fa-chevron-down");
          icon.classList.add("fa-chevron-up");
        } else {
          content.style.display = "none";
          icon.classList.remove("fa-chevron-up");
          icon.classList.add("fa-chevron-down");
        }
      }

      function closePaymentModal() {
        const modal = bootstrap.Modal.getInstance(
          document.getElementById("paymentModal")
        );
        if (modal) {
          modal.hide();
        }
      }

      async function submitPaymentProof() {
        const form = document.getElementById("paymentProofForm");
        const formData = new FormData(form);

        const fileInput = document.getElementById("paymentProof");
        if (!fileInput.files[0]) {
          showAlert("Silakan pilih file bukti pembayaran", "danger");
          return;
        }

        // Validate file size (5MB max)
        const maxSize = 5 * 1024 * 1024; // 5MB
        if (fileInput.files[0].size > maxSize) {
          showAlert("Ukuran file terlalu besar. Maksimal 5MB", "danger");
          return;
        }

        try {
          // In a real implementation, you would send this to a payment proof upload endpoint
          showAlert(
            "Bukti pembayaran berhasil dikirim! Tim kami akan memverifikasi dalam 1x24 jam.",
            "success"
          );

          // Close modal and reset form
          const modal = bootstrap.Modal.getInstance(
            document.getElementById("paymentModal")
          );
          modal.hide();
          form.reset();
        } catch (error) {
          console.error("Error submitting payment proof:", error);
          showAlert(
            "Terjadi kesalahan saat mengirim bukti pembayaran",
            "danger"
          );
        }
      }

      // Check URL parameters for specific actions
      function checkUrlParameters() {
        const urlParams = new URLSearchParams(window.location.search);
        const action = urlParams.get("action");

        if (action === "payment") {
          // Auto-open payment modal
          setTimeout(() => {
            openPaymentModal();
          }, 500);
        }
      }

      // Inisialisasi Bootstrap tooltip
      var tooltipTriggerList = [].slice.call(
        document.querySelectorAll('[data-bs-toggle="tooltip"]')
      );
      var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl);
      });
    </script>

    <!-- Confirmation Modal -->
    <div id="confirmModal" class="confirm-modal-overlay" style="display: none">
      <div class="confirm-modal">
        <div class="confirm-modal-header">
          <h4 id="confirmModalTitle">Konfirmasi</h4>
        </div>
        <div class="confirm-modal-body">
          <p id="confirmModalMessage">Apakah Anda yakin?</p>
        </div>
        <div class="confirm-modal-footer">
          <button id="confirmModalCancel" class="btn btn-secondary">
            Batal
          </button>
          <button id="confirmModalConfirm" class="btn btn-primary">Ya</button>
        </div>
      </div>
    </div>
  </body>
</html>
